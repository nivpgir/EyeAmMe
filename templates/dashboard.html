<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Excel Analysis</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>üìä Excel Analysis System</h1>
            <div class="header-right">
                <span class="user-name">{{ user.full_name }}</span>
                <a href="/api/logout" class="btn btn-secondary">Logout</a>
            </div>
        </div>
    </header>
    
    <main class="main-content">
        <!-- Upload Section -->
        <section class="card">
            <h2>Upload Excel File</h2>
            
            {% if error %}
            <div class="error">{{ error }}</div>
            {% endif %}
            
            <form method="post" action="/api/upload" enctype="multipart/form-data">
                <div class="upload-area">
                    <input type="file" name="file" id="file-input" accept=".xlsx,.xls" required>
                    <label for="file-input" class="file-label">
                        <span class="upload-icon">‚¨ÜÔ∏è</span>
                        <span>Click to select Excel file</span>
                        <span class="file-hint">Supports .xlsx and .xls files</span>
                    </label>
                </div>
                
                <button type="submit" class="btn btn-primary">Upload & Analyze</button>
            </form>
        </section>
        
        <!-- Files List Section -->
        <section class="card">
            <h2>Your Files</h2>
            
            {% if files %}
            <div class="files-grid">
                {% for file in files %}
                <div class="file-card">
                    <div class="file-header">
                        <span class="file-icon">üìÑ</span>
                        <h3>{{ file.filename }}</h3>
                    </div>
                    
                    <div class="file-info">
                        <p><strong>Status:</strong> <span class="status status-{{ file.status }}">{{ file.status }}</span></p>
                        <p><strong>Uploaded:</strong> {{ file.upload_date[:10] }}</p>
                        <p><strong>Size:</strong> {{ "%.2f"|format(file.file_size / 1024) }} KB</p>
                    </div>
                    
                    <div class="file-actions">
                        {% if file.status == 'completed' %}
                        <a href="/report/{{ file.file_id }}" class="btn btn-primary btn-sm">View Report</a>
                        {% endif %}
                        
                        <form method="post" action="/api/delete/{{ file.file_id }}" style="display: inline;">
                            <button type="submit" class="btn btn-danger btn-sm" 
                                    onclick="return confirm('Are you sure you want to delete this file?')">
                                Delete
                            </button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>No files uploaded yet</p>
                <p class="empty-hint">Upload an Excel file to get started</p>
            </div>
            {% endif %}
        </section>
    </main>
    
    <script>
        // Show selected filename
        document.getElementById('file-input').addEventListener('change', function(e) {
            const label = document.querySelector('.file-label span:nth-child(2)');
            if (e.target.files.length > 0) {
                label.textContent = e.target.files[0].name;
            } else {
                label.textContent = 'Click to select Excel file';
            }
        });
    </script>
</body>
</html>
